{% extends "admin_dashboard.html" %}
{% block content %}
<style>
/* --- General Body/Container Styling (Assuming dark base from admin_dashboard) --- */
.feedback-container {
    padding: 20px;
    background-color: #111; /* Very dark background for the specific container */
    border-radius: 8px;
    color: #eee;
    margin-left: 263px;
    min-height: 80vh; /* Ensure container takes up some space */

  }

h2 {
    color: #9370DB; /* Medium Purple for the main header */
    border-bottom: 2px solid #333;
    padding-bottom: 10px;
    margin-bottom: 25px;
}

/* --- Filter Form Styling --- */
.filter-form {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
    align-items: center;
    padding: 10px;
    background-color: #1a1a1a;
    border-radius: 6px;
    border: 1px solid #333;
}

.filter-form label {
    font-size: 14px;
    color: #ccc;
    font-weight: bold;
}

.filter-form select, .filter-form input[type="text"] {
    background: #2a2a2a; /* Slightly lighter dark for inputs */
    border: 1px solid #444;
    padding: 8px 10px;
    border-radius: 6px;
    color: #fff;
    font-size: 14px;
    transition: border-color 0.3s;
}

.filter-form select:focus, .filter-form input[type="text"]:focus {
    border-color: #9370DB; /* Purple focus */
    outline: none;
}

.filter-form button {
    background: #9370DB; /* Medium Purple for primary action button */
    border: none;
    padding: 8px 15px;
    border-radius: 6px;
    color: #fff;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}

.filter-form button:hover {
    background: #7B68EE; /* Darker/Royal Purple on hover */
}

.filter-form a {
    color: #aaa;
    font-size: 13px;
    text-decoration: none;
    padding: 5px; /* Added padding for better hit area */
    transition: color 0.3s;
}

.filter-form a:hover {
    color: #9370DB; /* Purple on hover */
}

/* --- Table Styling --- */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background-color: #1a1a1a;
    border-radius: 8px;
    overflow: hidden; /* Ensures border-radius applies to corners */
}

thead th {
    background-color: #222; /* Darker header background */
    color: #9370DB; /* Purple text for headers */
    text-align: left;
    padding: 12px 15px;
    font-size: 14px;
    border-bottom: 2px solid #444;
}

tbody tr {
    border-bottom: 1px solid #333; /* Subtle separator */
    transition: background-color 0.3s;
}

tbody tr:nth-child(even) {
    background-color: #1e1e1e; /* Slight striping for readability */
}

tbody tr:hover {
    background-color: #2a2a2a; /* Highlight row on hover */
}

tbody td {
    padding: 12px 15px;
    font-size: 14px;
    color: #ccc;
    vertical-align: top;
}

.empty-row {
    text-align: center;
    padding: 20px !important;
    color: #888;
    font-style: italic;
}

/* --- Rating Stars Styling --- */
.rating-stars {
    white-space: nowrap; /* Keep stars on a single line */
}

.filled-star {
    color: #FFD700; /* Gold/Yellow for filled stars */
    font-size: 18px;
}

.empty-star {
    color: #444; /* Dark gray for empty stars */
    font-size: 18px;
}
</style>

<div class="feedback-container">
    <h2>üí¨ Feedback Dashboard</h2>

    <form method="get" class="filter-form">
        <label for="rating">Rating:</label>
        <select name="rating" id="rating">
            <option value="">All</option>
            {% for i in "12345"|make_list %}
                <option value="{{ i }}" {% if request.GET.rating == i %}selected{% endif %}>
                    {{ i }} Stars
                </option>
            {% endfor %}
        </select>

        <label for="search">Search:</label>
        <input type="text" name="search" id="search" placeholder="Name / Email"
               value="{{ request.GET.search }}">

        <button type="submit">Filter</button>
        <a href="{% url 'feedback_dashboard' %}">Reset</a>
    </form>

    <table>
        <thead>
            <tr>
                <th style="width: 15%;">Name</th>
                <th style="width: 20%;">Email</th>
                <th style="width: 15%;">Rating</th>
                <th style="width: 40%;">Message</th>
                <th style="width: 10%;">Submitted</th>
            </tr>
        </thead>
        <tbody>
            {% for fb in feedbacks %}
            <tr>
                <td>{{ fb.name }}</td>
                <td>{{ fb.email }}</td>
                <td class="rating-stars">
                    {% for i in "12345"|make_list %}
                        {% if forloop.counter <= fb.rating %}
                            <span class="filled-star">‚≠ê</span>
                        {% else %}
                            <span class="empty-star">‚òÜ</span>
                        {% endif %}
                    {% endfor %}
                </td>
                <td>{{ fb.message }}</td>
                <td>{{ fb.created_at|date:"M d, Y" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="empty-row">No feedback has been submitted yet.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
