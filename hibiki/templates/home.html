{% extends "Sidebar.html" %} {% block content %}

<h2>Ready to play some song, {{ username }} ðŸ‘‹</h2>

<h3>{{ title.1 }}</h3>
<div class="grid grid-4">
  {% for item in section1 %}
  <div class="card" onclick="fetch_data('{{ item.type }}','{{ item.id }}')">
    <img src="{{ item.img }}" alt="{{ item.title }}" />
    <div class="overlay">
      <h4>{{ item.title }}</h4>
    </div>
  </div>
  {% endfor %}
</div>

<!-- Recommendations -->
<h3>{{ title.2 }}</h3>
<div class="grid grid-3">
  {% for item in section2 %}
  <div class="card" onclick="fetch_data('{{ item.type }}','{{ item.id }}')">
    <img src="{{ item.img }}" alt="{{ item.title }}" />
    <div class="overlay">
      <h4>{{ item.title }}</h4>
    </div>
  </div>
  {% endfor %}
</div>

<!-- Popular Songs -->
<h3>{{ title.0 }}</h3>
<div class="quick-picks">
  {% for item in section3 %}
  <div
    class="song-card"
    onclick="fetch_data('{{ item.type }}','{{ item.id }}')"
  >
    <img src="{{ item.img }}" alt="{{ item.artist }}" />
    <div class="song-info">
      <p class="song-title">{{ item.title }}</p>
      <p class="song-artist">{{ item.artist }}</p>
    </div>
  </div>
  {% endfor %}
</div>

<script>
  function fetch_data(type1, id) {
    if (type1 == "song") {
      window.playSongId(id)
    } else {
      window.location.href = `/playlist?id=${id}`
    }
  }

  window.addEventListener("DOMContentLoaded", () => {
    const params = new URLSearchParams(window.location.search)
    const songId = params.get("songId")

    if (!songId) return

    if(songId) window.playSongId(songId)
    
  })
</script>
{% endblock %}
